#!/arnix/bin/busybox sh

source /arnix/bin/shared.sh
source /arnix/etc/arnix.conf

tput setaf 5
cat << splash

          :::     :::::::::  ::::    ::: ::::::::::: :::    ::: 
       :+: :+:   :+:    :+: :+:+:   :+:     :+:     :+:    :+:  
     +:+   +:+  +:+    +:+ :+:+:+  +:+     +:+      +:+  +:+    
   +#++:++#++: +#++:++#:  +#+ +:+ +#+     +#+       +#++:+      
  +#+     +#+ +#+    +#+ +#+  +#+#+#     +#+      +#+  +#+      
 #+#     #+# #+#    #+# #+#   #+#+#     #+#     #+#    #+#      
###     ### ###    ### ###    #### ########### ###    ###

            Arch Linux with generations to come

splash
tput sgr0

_option() {
    tput setaf 5
    echo -n 'arnixctl '
    tput bold
    echo -ne "$1"
    tput sgr0
    echo -n ' - '
    tput bold
    echo "$2"
    tput sgr0
}

case $1 in
    status)
        echo 'Created by https://github.com/GermanBread'
        echo
        echo "Active generation: $(readlink /arnix/generations/current)"
        echo
        echo "Arnix branch: ${_branch_preset}"
        echo "Arnix version: ${_arnix_version}"
        echo "Arnix update source: ${_update_source}"
    ;;
    branch)
        /arnix/bin/change-branch.sh
    ;;
    update)
        /arnix/bin/update-arnix.sh
    ;;
    create)
        /arnix/bin/create-generation.sh
    ;;
    switch)
        /arnix/bin/rollback.sh
    ;;
    delete)
        /arnix/bin/delete-generation.sh
    ;;
    uninstall)
        /arnix/bin/revert-hijack.sh
    ;;
    *)
        _option 'help' 'this menu'
        _option 'status' 'info about Arnix'
        _option 'branch' 'select update branch'
        _option 'update' "update Arnix's files"
        _option 'create' 'create a new generation'
        _option 'switch' 'switch to any generation'
        _option 'delete' 'delete a generation'
        _option 'uninstall' 'revert hijack'
    ;;
esac